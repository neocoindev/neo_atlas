<!-- Market Analysis Section - Улучшенная версия -->
<section class="market-analysis" id="overview">
    <div class="container">
        <div class="section-header">
            <h2 class="section-title">Анализ Рынка</h2>
            <p class="section-subtitle">Глубокое понимание конкурентного ландшафта и стратегических возможностей</p>
        </div>

        <!-- Market Overview Stats -->
        <div class="market-overview-stats">
            <div class="stat-card" data-aos="fade-up">
                <div class="stat-icon">
                    <i class="fas fa-globe-americas"></i>
                </div>
                <div class="stat-content">
                    <h3 class="stat-number" data-target="2.8">0</h3>
                    <p class="stat-label">Млрд $ размер рынка USA</p>
                    <span class="stat-growth">+23% годовой рост</span>
                </div>
            </div>
            
            <div class="stat-card" data-aos="fade-up" data-aos-delay="100">
                <div class="stat-icon">
                    <i class="fas fa-users"></i>
                </div>
                <div class="stat-content">
                    <h3 class="stat-number" data-target="45">0</h3>
                    <p class="stat-label">Млн целевая аудитория</p>
                    <span class="stat-growth">Растущий сегмент</span>
                </div>
            </div>
            
            <div class="stat-card" data-aos="fade-up" data-aos-delay="200">
                <div class="stat-icon">
                    <i class="fas fa-chart-line"></i>
                </div>
                <div class="stat-content">
                    <h3 class="stat-number" data-target="300">0</h3>
                    <p class="stat-label">Млн $ наша валюация</p>
                    <span class="stat-growth">15x потенциал роста</span>
                </div>
            </div>
        </div>

        <!-- Problem-Solution Matrix -->
        <div class="problem-solution-matrix">
            <div class="matrix-header">
                <h3>Проблема → Решение → Возможность</h3>
            </div>
            
            <div class="matrix-grid">
                <div class="matrix-card problem-card" data-aos="fade-right">
                    <div class="card-header">
                        <i class="fas fa-exclamation-triangle"></i>
                        <h4>ПРОБЛЕМА</h4>
                    </div>
                    <div class="card-content">
                        <h5>Путаница на рынке</h5>
                        <ul>
                            <li>3+ продукта с именем "Atlas Card"</li>
                            <li>Репутационные риски</li>
                            <li>Потеря доверия потребителей</li>
                            <li>Операционные сбои у конкурентов</li>
                        </ul>
                        <div class="impact-meter">
                            <span>Влияние на рынок:</span>
                            <div class="meter">
                                <div class="meter-fill" style="width: 85%" data-value="85"></div>
                            </div>
                            <span>85% негативное</span>
                        </div>
                    </div>
                </div>

                <div class="matrix-card solution-card" data-aos="fade-up" data-aos-delay="200">
                    <div class="card-header">
                        <i class="fas fa-lightbulb"></i>
                        <h4>РЕШЕНИЕ</h4>
                    </div>
                    <div class="card-content">
                        <h5>NEO ATLAS Экосистема</h5>
                        <ul>
                            <li>Единый бренд для всех сегментов</li>
                            <li>Премиальное позиционирование</li>
                            <li>Передовые технологии</li>
                            <li>Безупречный пользовательский опыт</li>
                        </ul>
                        <div class="solution-benefits">
                            <div class="benefit-item">
                                <span class="benefit-value">4x</span>
                                <span class="benefit-label">выше approval rate</span>
                            </div>
                            <div class="benefit-item">
                                <span class="benefit-value">0%</span>
                                <span class="benefit-label">процентная ставка</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="matrix-card opportunity-card" data-aos="fade-left" data-aos-delay="400">
                    <div class="card-header">
                        <i class="fas fa-rocket"></i>
                        <h4>ВОЗМОЖНОСТЬ</h4>
                    </div>
                    <div class="card-content">
                        <h5>Доминирование рынка</h5>
                        <ul>
                            <li>Консолидация 100% сегмента</li>
                            <li>Расширение в новые рынки</li>
                            <li>Технологическое лидерство</li>
                            <li>Стратегические партнерства</li>
                        </ul>
                        <div class="opportunity-timeline">
                            <div class="timeline-item">
                                <span class="year">2024</span>
                                <span class="milestone">Запуск NEO ATLAS</span>
                            </div>
                            <div class="timeline-item">
                                <span class="year">2025</span>
                                <span class="milestone">Захват 25% рынка</span>
                            </div>
                            <div class="timeline-item">
                                <span class="year">2026</span>
                                <span class="milestone">Международная экспансия</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Competitive Analysis -->
        <div class="competitive-analysis">
            <h3>Конкурентный Анализ</h3>
            
            <div class="competitors-grid">
                <div class="competitor-card atlas-luxury">
                    <div class="competitor-header">
                        <h4>Atlas Luxury (Lead Bank)</h4>
                        <span class="market-position">Premium Segment</span>
                    </div>
                    <div class="competitor-metrics">
                        <div class="metric-row">
                            <span>Годовая плата:</span>
                            <span class="value negative">$1,000</span>
                        </div>
                        <div class="metric-row">
                            <span>Целевая аудитория:</span>
                            <span class="value">Ultra-wealthy</span>
                        </div>
                        <div class="metric-row">
                            <span>Основная проблема:</span>
                            <span class="value negative">Не оправдывает стоимость</span>
                        </div>
                    </div>
                    <div class="competitive-score">
                        <span>Конкурентоспособность:</span>
                        <div class="score-bar">
                            <div class="score-fill" style="width: 35%"></div>
                        </div>
                        <span>35/100</span>
                    </div>
                </div>

                <div class="competitor-card atlas-credit">
                    <div class="competitor-header">
                        <h4>Atlas Credit-Builder</h4>
                        <span class="market-position">Credit Building</span>
                    </div>
                    <div class="competitor-metrics">
                        <div class="metric-row">
                            <span>Годовая плата:</span>
                            <span class="value positive">$89</span>
                        </div>
                        <div class="metric-row">
                            <span>Целевая аудитория:</span>
                            <span class="value">No credit history</span>
                        </div>
                        <div class="metric-row">
                            <span>Основная проблема:</span>
                            <span class="value negative">Операционные сбои</span>
                        </div>
                    </div>
                    <div class="competitive-score">
                        <span>Конкурентоспособность:</span>
                        <div class="score-bar">
                            <div class="score-fill" style="width: 60%"></div>
                        </div>
                        <span>60/100</span>
                    </div>
                </div>

                <div class="competitor-card axis-atlas">
                    <div class="competitor-header">
                        <h4>Axis Bank Atlas</h4>
                        <span class="market-position">Travel Rewards</span>
                    </div>
                    <div class="competitor-metrics">
                        <div class="metric-row">
                            <span>Годовая плата:</span>
                            <span class="value">₹5,000</span>
                        </div>
                        <div class="metric-row">
                            <span>Целевая аудитория:</span>
                            <span class="value">Frequent travelers</span>
                        </div>
                        <div class="metric-row">
                            <span>Основная проблема:</span>
                            <span class="value negative">Девальвация программы</span>
                        </div>
                    </div>
                    <div class="competitive-score">
                        <span>Конкурентоспособность:</span>
                        <div class="score-bar">
                            <div class="score-fill" style="width: 70%"></div>
                        </div>
                        <span>70/100</span>
                    </div>
                </div>

                <div class="competitor-card neo-atlas">
                    <div class="competitor-header">
                        <h4>NEO ATLAS CARD</h4>
                        <span class="market-position our-position">All Segments</span>
                    </div>
                    <div class="competitor-metrics">
                        <div class="metric-row">
                            <span>Экосистемный подход:</span>
                            <span class="value positive">✓ Все сегменты</span>
                        </div>
                        <div class="metric-row">
                            <span>Технологии:</span>
                            <span class="value positive">✓ AI-powered</span>
                        </div>
                        <div class="metric-row">
                            <span>Преимущество:</span>
                            <span class="value positive">Единый бренд</span>
                        </div>
                    </div>
                    <div class="competitive-score">
                        <span>Конкурентоспособность:</span>
                        <div class="score-bar our-score">
                            <div class="score-fill" style="width: 95%"></div>
                        </div>
                        <span>95/100</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Market Opportunity Chart -->
        <div class="market-opportunity-section">
            <h3>Рыночная Возможность</h3>
            
            <div class="opportunity-grid">
                <div class="opportunity-chart">
                    <canvas id="marketOpportunityChart" width="400" height="300"></canvas>
                </div>
                
                <div class="opportunity-insights">
                    <div class="insight-item">
                        <div class="insight-icon">
                            <i class="fas fa-bullseye"></i>
                        </div>
                        <div class="insight-content">
                            <h4>Total Addressable Market</h4>
                            <p class="insight-value">$12.5B</p>
                            <p class="insight-desc">Общий размер рынка премиальных карт</p>
                        </div>
                    </div>
                    
                    <div class="insight-item">
                        <div class="insight-icon">
                            <i class="fas fa-crosshairs"></i>
                        </div>
                        <div class="insight-content">
                            <h4>Serviceable Available Market</h4>
                            <p class="insight-value">$4.2B</p>
                            <p class="insight-desc">Доступный рынок для нашего решения</p>
                        </div>
                    </div>
                    
                    <div class="insight-item">
                        <div class="insight-icon">
                            <i class="fas fa-trophy"></i>
                        </div>
                        <div class="insight-content">
                            <h4>Serviceable Obtainable Market</h4>
                            <p class="insight-value">$850M</p>
                            <p class="insight-desc">Реалистичная доля рынка к 2028</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Risk Assessment Matrix -->
        <div class="risk-assessment">
            <h3>Матрица Рисков и Возможностей</h3>
            
            <div class="risk-matrix">
                <div class="risk-axes">
                    <div class="y-axis">
                        <span>Высокое влияние</span>
                        <span>Среднее влияние</span>
                        <span>Низкое влияние</span>
                    </div>
                    <div class="matrix-grid-container">
                        <div class="risk-item high-impact low-probability" style="left: 20%; top: 15%;">
                            <div class="risk-dot"></div>
                            <div class="risk-tooltip">
                                <h5>Регуляторные изменения</h5>
                                <p>Высокое влияние, низкая вероятность</p>
                            </div>
                        </div>
                        
                        <div class="risk-item medium-impact medium-probability" style="left: 50%; top: 45%;">
                            <div class="risk-dot"></div>
                            <div class="risk-tooltip">
                                <h5>Конкуренция</h5>
                                <p>Среднее влияние, средняя вероятность</p>
                            </div>
                        </div>
                        
                        <div class="risk-item high-impact high-probability opportunity" style="left: 80%; top: 20%;">
                            <div class="risk-dot"></div>
                            <div class="risk-tooltip">
                                <h5>Консолидация рынка</h5>
                                <p>Высокое влияние, высокая вероятность</p>
                                <span class="opportunity-badge">ВОЗМОЖНОСТЬ</span>
                            </div>
                        </div>
                    </div>
                    <div class="x-axis">
                        <span>Низкая вероятность</span>
                        <span>Средняя вероятность</span>
                        <span>Высокая вероятность</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<style>
/* Дополнительные стили для улучшенной секции анализа рынка */

.market-analysis {
    padding: 8rem 0;
    background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
    position: relative;
    overflow: hidden;
}

.market-analysis::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="%23e2e8f0" stroke-width="0.5"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
    opacity: 0.3;
    z-index: 1;
}

.market-analysis .container {
    position: relative;
    z-index: 2;
}

/* Market Overview Stats */
.market-overview-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 2rem;
    margin-bottom: 5rem;
}

.stat-card {
    background: white;
    padding: 2.5rem;
    border-radius: 20px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
    display: flex;
    align-items: center;
    gap: 1.5rem;
    transition: all 0.3s ease;
    border: 1px solid rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(10px);
}

.stat-card:hover {
    transform: translateY(-10px);
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
}

.stat-icon {
    width: 80px;
    height: 80px;
    background: var(--gradient-primary);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2rem;
    color: white;
    flex-shrink: 0;
}

.stat-content h3 {
    font-size: 3rem;
    font-weight: 800;
    color: var(--primary-color);
    margin-bottom: 0.5rem;
}

.stat-content .stat-label {
    font-size: 1.1rem;
    color: var(--text-dark);
    margin-bottom: 0.5rem;
}

.stat-growth {
    display: inline-block;
    padding: 0.25rem 0.75rem;
    background: rgba(34, 197, 94, 0.1);
    color: #16a34a;
    border-radius: 20px;
    font-size: 0.9rem;
    font-weight: 600;
}

/* Problem-Solution Matrix */
.problem-solution-matrix {
    margin-bottom: 5rem;
}

.matrix-header {
    text-align: center;
    margin-bottom: 3rem;
}

.matrix-header h3 {
    font-size: 2.5rem;
    font-weight: 700;
    background: var(--gradient-primary);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.matrix-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
    gap: 2rem;
}

.matrix-card {
    background: white;
    border-radius: 20px;
    padding: 2rem;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
    transition: all 0.3s ease;
    border-top: 4px solid;
}

.problem-card {
    border-top-color: #ef4444;
}

.solution-card {
    border-top-color: #3b82f6;
}

.opportunity-card {
    border-top-color: #10b981;
}

.matrix-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
}

.card-header {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1.5rem;
}

.card-header i {
    font-size: 1.5rem;
    color: var(--primary-color);
}

.card-header h4 {
    font-size: 1.2rem;
    font-weight: 700;
    color: var(--text-dark);
}

.card-content h5 {
    font-size: 1.4rem;
    font-weight: 600;
    margin-bottom: 1rem;
    color: var(--text-dark);
}

.card-content ul {
    list-style: none;
    padding: 0;
    margin-bottom: 1.5rem;
}

.card-content ul li {
    padding: 0.5rem 0;
    border-bottom: 1px solid #f1f5f9;
    position: relative;
    padding-left: 1.5rem;
}

.card-content ul li::before {
    content: '•';
    position: absolute;
    left: 0;
    color: var(--primary-color);
    font-weight: bold;
}

/* Impact Meter */
.impact-meter {
    display: flex;
    align-items: center;
    gap: 1rem;
    font-size: 0.9rem;
    color: var(--text-light);
}

.meter {
    flex: 1;
    height: 8px;
    background: #e2e8f0;
    border-radius: 4px;
    overflow: hidden;
}

.meter-fill {
    height: 100%;
    background: linear-gradient(90deg, #ef4444, #f97316);
    transition: width 2s ease;
}

/* Solution Benefits */
.solution-benefits {
    display: flex;
    gap: 1rem;
}

.benefit-item {
    text-align: center;
    padding: 1rem;
    background: var(--gray-color);
    border-radius: 10px;
    flex: 1;
}

.benefit-value {
    display: block;
    font-size: 2rem;
    font-weight: 800;
    color: var(--primary-color);
}

.benefit-label {
    font-size: 0.9rem;
    color: var(--text-light);
}

/* Opportunity Timeline */
.opportunity-timeline {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.timeline-item {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 0.75rem;
    background: var(--gray-color);
    border-radius: 10px;
}

.timeline-item .year {
    font-weight: 700;
    color: var(--primary-color);
    min-width: 60px;
}

.timeline-item .milestone {
    color: var(--text-dark);
    font-weight: 500;
}

/* Competitive Analysis */
.competitive-analysis {
    margin-bottom: 5rem;
}

.competitive-analysis h3 {
    font-size: 2.5rem;
    font-weight: 700;
    text-align: center;
    margin-bottom: 3rem;
    color: var(--text-dark);
}

.competitors-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 2rem;
}

.competitor-card {
    background: white;
    border-radius: 20px;
    padding: 2rem;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
    transition: all 0.3s ease;
}

.competitor-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
}

.competitor-header {
    margin-bottom: 1.5rem;
}

.competitor-header h4 {
    font-size: 1.3rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
    color: var(--text-dark);
}

.market-position {
    display: inline-block;
    padding: 0.25rem 0.75rem;
    background: var(--gray-color);
    color: var(--text-light);
    border-radius: 15px;
    font-size: 0.8rem;
    font-weight: 600;
}

.our-position {
    background: var(--gradient-primary);
    color: white;
}

.competitor-metrics {
    margin-bottom: 1.5rem;
}

.metric-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.75rem 0;
    border-bottom: 1px solid #f1f5f9;
}

.metric-row:last-child {
    border-bottom: none;
}

.value {
    font-weight: 600;
}

.value.positive {
    color: #16a34a;
}

.value.negative {
    color: #dc2626;
}

.competitive-score {
    display: flex;
    align-items: center;
    gap: 1rem;
    font-size: 0.9rem;
}

.score-bar {
    flex: 1;
    height: 8px;
    background: #e2e8f0;
    border-radius: 4px;
    overflow: hidden;
}

.score-fill {
    height: 100%;
    background: linear-gradient(90deg, #ef4444, #f59e0b, #10b981);
    transition: width 2s ease;
}

.our-score .score-fill {
    background: var(--gradient-primary);
}

/* Market Opportunity Section */
.market-opportunity-section {
    margin-bottom: 5rem;
}

.market-opportunity-section h3 {
    font-size: 2.5rem;
    font-weight: 700;
    text-align: center;
    margin-bottom: 3rem;
    color: var(--text-dark);
}

.opportunity-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 3rem;
    align-items: center;
}

.opportunity-chart {
    background: white;
    padding: 2rem;
    border-radius: 20px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
}

.opportunity-insights {
    display: flex;
    flex-direction: column;
    gap: 2rem;
}

.insight-item {
    display: flex;
    align-items: center;
    gap: 1.5rem;
    padding: 2rem;
    background: white;
    border-radius: 20px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
    transition: all 0.3s ease;
}

.insight-item:hover {
    transform: translateX(10px);
}

.insight-icon {
    width: 60px;
    height: 60px;
    background: var(--gradient-primary);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    color: white;
    flex-shrink: 0;
}

.insight-content h4 {
    font-size: 1.1rem;
    font-weight: 600;
    margin-bottom: 0.5rem;
    color: var(--text-dark);
}

.insight-value {
    font-size: 2rem;
    font-weight: 800;
    color: var(--primary-color);
    margin-bottom: 0.25rem;
}

.insight-desc {
    font-size: 0.9rem;
    color: var(--text-light);
}

/* Risk Assessment Matrix */
.risk-assessment {
    margin-bottom: 3rem;
}

.risk-assessment h3 {
    font-size: 2.5rem;
    font-weight: 700;
    text-align: center;
    margin-bottom: 3rem;
    color: var(--text-dark);
}

.risk-matrix {
    background: white;
    border-radius: 20px;
    padding: 2rem;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
}

.risk-axes {
    position: relative;
    height: 400px;
}

.y-axis {
    position: absolute;
    left: -100px;
    top: 0;
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    align-items: flex-end;
    font-size: 0.9rem;
    color: var(--text-light);
    writing-mode: vertical-rl;
    text-orientation: mixed;
}

.x-axis {
    position: absolute;
    bottom: -50px;
    left: 0;
    width: 100%;
    display: flex;
    justify-content: space-between;
    font-size: 0.9rem;
    color: var(--text-light);
}

.matrix-grid-container {
    position: relative;
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, #fee2e2 0%, #fef3c7 50%, #d1fae5 100%);
    border-radius: 10px;
    border: 2px solid #e2e8f0;
}

.risk-item {
    position: absolute;
    cursor: pointer;
}

.risk-dot {
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background: var(--primary-color);
    border: 3px solid white;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    transition: all 0.3s ease;
}

.risk-item.opportunity .risk-dot {
    background: #10b981;
}

.risk-item:hover .risk-dot {
    transform: scale(1.3);
}

.risk-tooltip {
    position: absolute;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%);
    background: var(--dark-color);
    color: white;
    padding: 1rem;
    border-radius: 10px;
    min-width: 200px;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
    z-index: 10;
}

.risk-item:hover .risk-tooltip {
    opacity: 1;
    visibility: visible;
}

.risk-tooltip h5 {
    font-weight: 600;
    margin-bottom: 0.5rem;
}

.risk-tooltip p {
    font-size: 0.9rem;
    margin-bottom: 0.5rem;
}

.opportunity-badge {
    display: inline-block;
    padding: 0.25rem 0.5rem;
    background: #10b981;
    color: white;
    border-radius: 5px;
    font-size: 0.7rem;
    font-weight: 600;
}

/* Responsive Design */
@media (max-width: 768px) {
    .opportunity-grid {
        grid-template-columns: 1fr;
        gap: 2rem;
    }
    
    .matrix-grid {
        grid-template-columns: 1fr;
    }
    
    .competitors-grid {
        grid-template-columns: 1fr;
    }
    
    .market-overview-stats {
        grid-template-columns: 1fr;
    }
    
    .stat-card {
        flex-direction: column;
        text-align: center;
    }
    
    .y-axis {
        display: none;
    }
    
    .x-axis {
        position: relative;
        bottom: 0;
        margin-top: 1rem;
    }
}
</style>

<script>
// Дополнительный JavaScript для интерактивности

// Инициализация графика рыночной возможности
function initMarketOpportunityChart() {
    const ctx = document.getElementById('marketOpportunityChart');
    if (!ctx) return;
    
    // Простая реализация без Chart.js
    const canvas = ctx;
    const context = canvas.getContext('2d');
    
    // Данные для графика
    const data = [
        { label: 'TAM', value: 12.5, color: '#3b82f6' },
        { label: 'SAM', value: 4.2, color: '#10b981' },
        { label: 'SOM', value: 0.85, color: '#f59e0b' }
    ];
    
    // Рисуем концентрические круги
    const centerX = canvas.width / 2;
    const centerY = canvas.height / 2;
    const maxRadius = Math.min(centerX, centerY) - 20;
    
    data.forEach((item, index) => {
        const radius = maxRadius * (1 - index * 0.3);
        
        context.beginPath();
        context.arc(centerX, centerY, radius, 0, 2 * Math.PI);
        context.fillStyle = item.color + '40'; // 40 для прозрачности
        context.fill();
        context.strokeStyle = item.color;
        context.lineWidth = 3;
        context.stroke();
        
        // Добавляем текст
        context.fillStyle = item.color;
        context.font = 'bold 16px Inter';
        context.textAlign = 'center';
        context.fillText(
            `${item.label}: $${item.value}B`, 
            centerX, 
            centerY - radius + 30
        );
    });
}

// Анимация счетчиков при скролле
function animateMarketCounters() {
    const counters = document.querySelectorAll('.market-overview-stats .stat-number');
    
    counters.forEach(counter => {
        const target = parseFloat(counter.getAttribute('data-target'));
        const increment = target / 100;
        let current = 0;
        
        const updateCounter = () => {
            if (current < target) {
                current += increment;
                if (target < 10) {
                    counter.textContent = current.toFixed(1);
                } else {
                    counter.textContent = Math.ceil(current);
                }
                setTimeout(updateCounter, 20);
            } else {
                if (target < 10) {
                    counter.textContent = target.toFixed(1);
                } else {
                    counter.textContent = target;
                }
            }
        };
        
        updateCounter();
    });
}

// Анимация заполнения прогресс-баров
function animateProgressBars() {
    const progressBars = document.querySelectorAll('.meter-fill, .score-fill');
    
    progressBars.forEach(bar => {
        const targetWidth = bar.style.width;
        bar.style.width = '0%';
        
        setTimeout(() => {
            bar.style.width = targetWidth;
        }, 500);
    });
}

// Инициализация при загрузке
document.addEventListener('DOMContentLoaded', function() {
    setTimeout(() => {
        initMarketOpportunityChart();
        animateMarketCounters();
        animateProgressBars();
    }, 1000);
});

// Добавляем к существующему observer
const marketObserver = new IntersectionObserver(function(entries) {
    entries.forEach(entry => {
        if (entry.isIntersecting && entry.target.classList.contains('market-analysis')) {
            animateMarketCounters();
            animateProgressBars();
        }
    });
}, { threshold: 0.3 });

const marketSection = document.querySelector('.market-analysis');
if (marketSection) {
    marketObserver.observe(marketSection);
}
</script>
